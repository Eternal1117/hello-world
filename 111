<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>房间点歌系统</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        .container { max-width: 800px; margin: 50px auto; padding: 0 20px; }
        .page { display: none; }
        .page.active { display: block; }
        h1, h2 { margin-bottom: 20px; color: #333; }
        input, button { padding: 10px 15px; margin: 8px 0; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; }
        button { background: #4285f4; color: white; border: none; cursor: pointer; }
        button:hover { background: #3367d6; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #666; }
        .song-list { margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px; }
        .song-item { padding: 10px; margin: 8px 0; background: #f8f9fa; border-radius: 4px; }
        .error { color: #d93025; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <!-- 1. 房间入口页 -->
        <div id="enter-page" class="page active">
            <h1>进入点歌房间</h1>
            <div class="form-group">
                <label for="room-id">房间号</label>
                <input type="text" id="room-id" placeholder="请输入房间号（如1001）" required>
            </div>
            <button onclick="enterRoom()">进入房间</button>
            <p style="margin-top: 20px;">管理员入口？点击这里</p >
        </div>
        <!-- 2. 房间点歌页 -->
        <div id="room-page" class="page">
            <h2 id="room-title">房间：1001</h2>
            <div class="form-group">
                <label for="singer">歌手名</label>
                <input type="text" id="singer" placeholder="请输入歌手名字" required>
            </div>
            <div class="form-group">
                <label for="song">歌曲名</label>
                <input type="text" id="song" placeholder="请输入歌曲名字" required>
            </div>
            <button onclick="addSong()">提交点歌</button>
            <div class="error" id="room-error"></div>
            
            <div class="song-list">
                <h3>本房间点歌列表</h3>
                <div id="room-song-list"></div>
            </div>
            <button onclick="showPage('enter-page')" style="margin-top: 20px; background: #666;">退出房间</button>
        </div>
        <!-- 3. 管理员登录页 -->
        <div id="admin-login-page" class="page">
            <h1>管理员登录</h1>
            <div class="form-group">
                <label for="admin-key">管理员密钥</label>
                <input type="password" id="admin-key" placeholder="请输入管理员密钥" required>
            </div>
            <button onclick="adminLogin()">登录</button>
            <div class="error" id="admin-error"></div>
            <p style="margin-top: 20px;">返回用户入口</p >
        </div>
        <!-- 4. 管理员后台页 -->
        <div id="admin-page" class="page">
            <h1>管理员后台 - 所有房间点歌数据</h1>
            <div id="all-rooms-data"></div>
            <button onclick="adminLogout()" style="margin-top: 20px; background: #d93025;">退出登录</button>
        </div>
    </div>
    <script>
        // 全局配置（可修改管理员密钥）
        const ADMIN_KEY = "20071117liu"; // 你的管理员密钥已保留
        let currentRoomId = "";

        // 1. 页面切换
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            // 清空错误提示
            document.querySelectorAll('.error').forEach(el => el.textContent = '');
        }

        // 2. 进入房间逻辑
        function enterRoom() {
            const roomId = document.getElementById('room-id').value.trim();
            if (!roomId) {
                document.getElementById('room-error').textContent = "请输入房间号！";
                return;
            }
            currentRoomId = roomId;
            // 更新房间标题
            document.getElementById('room-title').textContent = `房间：${roomId}`;
            // 加载该房间的点歌列表
            loadRoomSongs();
            // 切换到房间页
            showPage('room-page');
        }

        // 3. 提交点歌逻辑（补全中断部分）
        function addSong() {
            const singer = document.getElementById('singer').value.trim();
            const song = document.getElementById('song').value.trim();
            if (!singer || !song) {
                document.getElementById('room-error').textContent = "歌手名和歌曲名不能为空！";
                return;
            }

            // 1. 获取本地存储的所有数据
            let allData = JSON.parse(localStorage.getItem('songRoomData')) || {};
            // 2. 确保当前房间的数据存在
            if (!allData[currentRoomId]) allData[currentRoomId] = [];
            // 3. 添加新点歌（补全time属性和数据存储逻辑）
            allData[currentRoomId].push({
                singer: singer,
                song: song,
         
